<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="description" content="An interactive dashboard exposing the links between Russian disinformation campaigns and affiliated Canadian conservative media and political groups. Includes timeline analysis, bot activity, narrative tracking, and more.">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Disinfo Influence Dashboard</title>
  <!-- Chart.js v4 (locked) -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

<!-- Annotation plugin v2.x ‚Äì compatible with Chart¬†3/4 -->
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@2.2.2"></script>

<!-- Register the plugin (Chart¬†3+ requires explicit registration) -->
<script>
  /* global Chart */
  Chart.register(window['chartjs-plugin-annotation']);
</script>

  <script src="https://cdn.jsdelivr.net/npm/cytoscape@3.23.0/dist/cytoscape.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/cytoscape-dagre@2.4.0/cytoscape-dagre.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2"></script>
  <script src="https://unpkg.com/tippy.js@6/dist/tippy-bundle.umd.min.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/tippy.js@6/themes/light.css">
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(to bottom right, #1c1f26, #3a3f4b);
      color: #e4e4e4;
    }
    header { background-color: #2a2f4a; color: white; padding: 1rem; text-align: center; }
    nav {
      display: flex;
      justify-content: center;
      background-color: #1e2233;
      flex-wrap: wrap;
    }
    nav a {
      color: white;
      padding: 0.75rem 1rem;
      text-decoration: none;
      display: inline-block;
    }
    nav a:hover { background-color: #3a4059; }
    section {
      padding: 1rem 2rem;
      max-width: 1200px;
      margin: auto;
      background-color: rgba(255, 255, 255, 0.03);
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }
    h2 {
      color: #ffffff;
      border-bottom: 2px solid #555;
      padding-bottom: 0.5rem;
    }
    canvas {
      width: 100%;
      max-width: 100%;
      background-color: #1c1f26;
      border-radius: 8px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.3);
    }
    textarea {
      width: 100%;
      max-width: 100%;
      background-color: #2a2f4a;
      color: #e4e4e4;
      border: 1px solid #444;
      border-radius: 5px;
      padding: 0.5rem;
    }
    button {
      background-color: #2a2f4a;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: #3f456a;
    }
    @media (max-width: 768px) {
      textarea { width: 100% !important; }
      nav { flex-direction: column; }
    }
    .kpi-container {
      display: flex;
      justify-content: space-around;
      flex-wrap: wrap;
      margin-bottom: 2rem;
      gap: 1rem;
    }
    .kpi {
      background: rgba(255, 255, 255, 0.05);
      padding: 1rem 2rem;
      border: 1px solid #444;
      border-radius: 10px;
      flex: 1 1 200px;
      text-align: center;
      box-shadow: 0 2px 5px rgba(0,0,0,0.4);
    }
    .kpi h3 {
      margin: 0.5rem 0;
      font-size: 1.5rem;
      color: #ffffff;
    }
    footer { text-align: center; padding: 1rem; background-color: #1e2233; color: #e4e4e4; }
    footer a { color: #6ca0dc; text-decoration: none; }
    footer a:hover { text-decoration: underline; }
    .tooltip-icon { cursor: pointer; border-bottom: 1px dotted #fff; color: #fff; font-weight: bold; }
  </style>
</head>
<body>
  <header>
    <h1>Disinfo Influence Dashboard</h1>
  </header>

  <nav>
    <a href="#">Home</a>
  </nav>

  <section>
    <h2>About This Dashboard</h2>
    <p>This dashboard tracks disinformation and propaganda flows from Russian-affiliated sources into Canadian conservative political circles. <span class="tooltip-icon" data-tippy-content="A visual representation of the connections between various entities.">What is the Network Graph?</span> | <span class="tooltip-icon" data-tippy-content="Shows narrative trends and major events.">Timeline Explanation</span> | <span class="tooltip-icon" data-tippy-content="Measures similarity between narratives using NLP algorithms.">About NLP Tool</span></p>
  </section>

  <section id="network">
  <h2>Network Graph</h2>
  <div id="cy" style="height: 400px;"></div>
</section>

<section id="timeline">
  <h2>Narrative Timeline</h2>
  <canvas id="timelineChart" height="200"></canvas>
</section>

<section id="bots">
  <h2>Bot Activity Heatmap</h2>
  <canvas id="botHeatmap" height="200"></canvas>
</section>

<section id="sankey">
  <h2>Sankey Flow Diagram</h2>
  <iframe width="100%" height="400" style="border:0;" srcdoc='<html><body style="margin:0;overflow:hidden"><div style="color:#aaa;font-family:sans-serif;text-align:center;padding-top:100px;">Sankey diagram placeholder</div></body></html>'></iframe>
</section>

<section id="nlp">
  <h2>NLP Narrative Similarity Tool</h2>
  <form style="display: flex; gap: 1rem; flex-wrap: wrap;">
    <textarea placeholder="Paste Kremlin narrative..." style="flex: 1 1 45%; height: 150px;"></textarea>
    <textarea placeholder="Paste CPC-aligned message..." style="flex: 1 1 45%; height: 150px;"></textarea>
    <button type="button" style="margin-top: 1rem;">Compare</button>
  </form>
</section>

<section id="export">
  <h2>Export Tools</h2>
  <button onclick="window.print()">üñ®Ô∏è Print / Save as PDF</button>
</section>

<script>
  const cy = cytoscape({
    container: document.getElementById('cy'),
    elements: [
      { data: { id: 'RT' } },
      { data: { id: 'GlobalResearch' } },
      { data: { id: 'CanadaProud' } },
      { data: { source: 'RT', target: 'GlobalResearch' } },
      { data: { source: 'GlobalResearch', target: 'CanadaProud' } }
    ],
    style: [
      { selector: 'node', style: { 'label': 'data(id)', 'background-color': '#4caf50', 'color': '#fff' } },
      { selector: 'edge', style: { 'line-color': '#ccc', 'width': 2 } }
    ],
    layout: { name: 'circle' }
  });

  new Chart(document.getElementById('timelineChart'), {
    type: 'line',
    data: {
      labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
      datasets: [{
        label: 'Narrative Spike',
        data: [10, 30, 75, 40],
        borderColor: 'rgba(255, 255, 255, 0.85)',
        backgroundColor: 'rgba(255, 255, 255, 0.2)',
        fill: true,
        tension: 0.4
      }]
    },
    options: { responsive: true }
  });

  new Chart(document.getElementById('botHeatmap'), {
    type: 'bar',
    data: {
      labels: ['12AM', '3AM', '6AM', '9AM', '12PM', '3PM', '6PM', '9PM'],
      datasets: [{
        label: 'Bot Posts',
        data: [5, 8, 12, 25, 30, 40, 38, 22],
        backgroundColor: 'rgba(255, 99, 132, 0.7)'
      }]
    },
    options: { responsive: true }
  });
</script>
<footer>
    <p>&copy; 2024 Disinfo Influence Dashboard | Data sources: <a href="https://informationlaundromat.com" target="_blank">Information Laundromat</a>, <a href="https://pressprogress.ca" target="_blank">PressProgress</a> | <a href="#">Feedback</a></p>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      if (typeof tippy !== 'undefined') {
        tippy('.tooltip-icon', { theme: 'light', animation: 'scale' });
      } else {
        console.error('Tippy.js failed to load');
      }
    });
  </script>
</body>
</html>
